<div class="container mx-auto p-4">
    <div class="mb-4 flex gap-4">
        <select [(ngModel)]="startMonth" (change)="updateDateRange(startMonth, endMonth)" class="border rounded p-2">
            <option *ngFor="let month of months; let i = index" [value]="i">{{month}}</option>
        </select>
        <select [(ngModel)]="endMonth" (change)="updateDateRange(startMonth, endMonth)" class="border rounded p-2">
            <option *ngFor="let month of months; let i = index" [value]="i">{{month}}</option>
        </select>
    </div>

    <table class="w-full border-collapse">
        <thead>
            <tr>
                <th class="border p-2">Category</th>
                <th *ngFor="let month of months" class="border p-2">{{month}}</th>
                <th class="border p-2">Actions</th>
            </tr>
        </thead>
        <tbody>
            <ng-container *ngFor="let category of budgetCategories">
                <tr>
                    <td class="border p-2">{{category.name}}</td>
                    <td *ngFor="let month of months" 
                        class="border p-2" 
                        [class.bg-blue-100]="selectedCell?.categoryId === category.id && selectedCell?.month === month">
                        <input
                            type="number"
                            [(ngModel)]="category.values[month]"
                            (focus)="onCellSelect(category.id, month)"
                            (contextmenu)="onRightClick($event, category.id, month)"
                            class="w-full border-0 focus:outline-none"
                        >
                    </td>
                    <td class="border p-2">
                        <button (click)="deleteCategory(category.id)" class="text-red-500">Delete</button>
                    </td>
                </tr>
            </ng-container>
            <tr class="font-bold bg-gray-100">
                <td class="border p-2">Total</td>
                <td *ngFor="let entry of budgetEntries" class="border p-2">
                    {{entry.profitLoss | number:'1.2-2'}}
                </td>
                <td class="border p-2"></td>
            </tr>
        </tbody>
    </table>
</div>